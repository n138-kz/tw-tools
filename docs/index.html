<!--
LICENSE)
Copyright n138-kz and other contributors
Released under the MIT license
--><!DOCTYPE html><html lang="ja">
<head>
	<meta charset="utf-8" />
	<title>tw-tools</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-Control" content="no-cache">
	<meta http-equiv="Expires" content="0">
	<link rel="preconnect dns-prefetch" href="//github.com">
	<link rel="preconnect dns-prefetch" href="//n138-kz.github.io">
	<link rel="preconnect dns-prefetch" href="//code.jquery.com">
	<link rel="preconnect dns-prefetch" href="//accounts.google.com">
	<link rel="preconnect dns-prefetch" href="//www.google.com">
	<link rel="stylesheet" type="text/css" href="https://n138-kz.github.io/lib/master.css?t=0" />
	<script src="https://n138-kz.github.io/lib/master.js"></script>
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://accounts.google.com/gsi/client" async defer></script>
	<script src="https://www.google.com/recaptcha/api.js?render=6LfCHdcUAAAAAOwkHsW_7W7MfoOrvoIw9CXdLRBA"></script>
	<script src="https://n138-kz.github.io/lib/grecaptcha.js"></script>
	<style>
		:root {
			height:100vh;
			box-sizing: border-box;
		}
		code {
			padding-left: 10px;
			padding-right: 10px;
		}
		h1,h2,ul,ol,li {
			margin: 0;
			padding: 0;
			margin-block-start: 0em;
			margin-block-end: 0em;
		}
		ul,ol {
			margin-left:20px;
			padding-left:20px;
		}
		textarea {
			min-height: 5em;
			width: stretch;
			width: -moz-available; /* Firefox */
			width: -webkit-fill-available; /* Safari */
		}
	</style>
	<script>
		function forceNameReplace(array) {
			return array.map((elem) => elem.replace(/(name=.*)/g, 'name=orig'))
		}
		function arrayUniq(array) {
			return array.filter((elem, index, self) => self.indexOf(elem) === index);
		}
		function splitLine(target) {
			target.value = target.value.split('https://').join('\nhttps://');
			target.value = target.value.split('http://').join('\nhttp://');
			target.value = target.value.split('ftp://').join('\nftp://');
			target.value = target.value.split('\n').sort().join('\n');
			target.value = arrayUniq(target.value.split('\n')).join('\n');
			target.value = forceNameReplace(target.value.split('\n')).join('\n');
			target.value = target.value.trim();
		}
		function download_list(target, section='') {
			target = target.parentNode.children.item(1);
			if(section == false) {
			} else if(section == '') {
			}
			e = [
				'wget \'',
				'\'&',
			];
			items = target.value.split('\n');
			items = items.map((elem) => `${e[0]}${elem}${e[1]}`);
			items.push('rename -v \'s/\\?.*//g\' *');
			items = items.join('\n') + '\n';
			console.log(items);
			
			blob = new Blob([items], {type: 'text/plain'});
			a = document.createElement('a');
			a.href = URL.createObjectURL(blob);
			a.target = '_blank';
			a.download = `${(btoa(location.href)).slice(0, 8)}_${Math.trunc(new Date().getTime()/10**3)}.txt`;
			a.click();

		}
	</script>
</head>
<body>
	<header>
		<div></div>
	</header>
	<section>
		<div>
			<fieldset>
				<legend><a href="//pbs.twimg.com">pbs.twimg.com</a></legend>
				<textarea id="" onblur="splitLine(this)" placeholder="https://pbs.twimg.com/media/GvmLVpGWgAAeWzo?format=jpg&name=orig"></textarea>
				<input type="button" value="Download list.txt" onclick="download_list(this)">
			</fieldset>
		</div>
	</section>
</body>
</html>
